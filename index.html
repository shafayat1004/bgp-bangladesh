<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BGP Bangladesh - Internet Path Visualization</title>
  <meta name="description" content="Interactive 3-layer visualization of Bangladesh's internet connectivity: Local ISPs, IIGs, and International Transit via BGP routing.">
  <meta property="og:title" content="BGP Bangladesh - Internet Path Visualization">
  <meta property="og:description" content="Explore Bangladesh's BGP routing paths and internet bottlenecks interactively.">
  <meta property="og:type" content="website">

  <link rel="stylesheet" href="assets/css/styles.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <div id="app">
    <!-- Sidebar -->
    <aside id="sidebar">
      <div id="sidebar-header">
        <h1>BGP Bangladesh</h1>
        <div id="data-source-label">Loading...</div>
      </div>
      <div id="sidebar-content">
        <!-- What's My ASN? -->
        <div class="controls-section my-asn-section">
          <button class="btn btn-my-asn" id="btn-my-asn">What's My ASN?</button>
          <div id="my-asn-result"></div>
          <div class="my-asn-note">Note: Default filter shows routes with 100+ observations. Lower the "Min Routes" slider to 0 to see smaller ISPs.</div>
        </div>

        <!-- Stats -->
        <div id="stats-container"></div>

        <!-- Controls -->
        <div class="controls-section">
          <div class="btn-group">
            <button class="btn" id="btn-fetch-live">Fetch Live Data</button>
            <button class="btn btn-outline" id="btn-revert-static">Static Data</button>
          </div>
          <div class="btn-group" style="margin-top: 8px;">
            <button class="btn btn-outline btn-small" id="btn-reset-view">Reset View</button>
            <button class="btn btn-outline btn-small" id="btn-toggle-labels">Labels</button>
          </div>
        </div>

        <!-- Search ASN -->
        <div class="controls-section">
          <div class="control-group">
            <label>Search ASN</label>
            <input type="text" id="search-asn" placeholder="Search by ASN or name..." class="search-input">
          </div>
        </div>

        <!-- Filters -->
        <div class="controls-section">
          <div class="control-group">
            <label>Min Routes: <span class="filter-value" id="filter-min-traffic-label">100</span></label>
            <input type="range" id="filter-min-traffic" min="0" max="40000" value="100" step="100">
          </div>
          <div class="control-group">
            <label>Max Routes: <span class="filter-value" id="filter-max-traffic-label">âˆž</span></label>
            <input type="range" id="filter-max-traffic" min="0" max="40000" value="40000" step="500">
          </div>
          <div class="control-group">
            <label>Node Size</label>
            <input type="range" id="filter-node-size" min="5" max="30" value="15" step="1">
          </div>
        </div>

        <!-- Type Filters -->
        <div class="controls-section">
          <div class="sidebar-section-title" style="color: var(--text-muted);">Show Types</div>
          <div class="type-filter-group" id="type-filter-checks">
            <label><input type="checkbox" data-type="local-isp" checked> <span style="color:#4dabf7">Local ISPs</span></label>
            <label><input type="checkbox" data-type="iig" checked> <span style="color:#51cf66">IIGs</span></label>
            <label><input type="checkbox" data-type="detected-iig" checked> <span style="color:#fcc419">Detected</span></label>
            <label><input type="checkbox" data-type="offshore-peer" checked> <span style="color:#ffa94d">Offshore</span></label>
            <label><input type="checkbox" data-type="outside" checked> <span style="color:#ff6b6b">Outside</span></label>
          </div>
        </div>

        <!-- Export -->
        <div class="controls-section">
          <div class="sidebar-section-title" style="color: var(--text-muted);">Export Data</div>
          <div class="btn-group">
            <button class="btn btn-outline btn-small" id="btn-export-nodes">Nodes CSV</button>
            <button class="btn btn-outline btn-small" id="btn-export-edges">Edges CSV</button>
            <button class="btn btn-outline btn-small" id="btn-export-json">JSON</button>
            <button class="btn btn-outline btn-small" id="btn-export-raw" title="Export raw BGP routes (available after live fetch, ~20MB)">Raw Routes</button>
          </div>
        </div>

        <!-- Legend -->
        <div class="controls-section legend-section">
          <div class="sidebar-section-title" style="color: var(--text-muted);">Legend</div>
          <div class="legend-items">
            <div class="legend-item"><span class="legend-dot" style="background:#4dabf7;"></span> Local ISPs</div>
            <div class="legend-item"><span class="legend-dot" style="background:#51cf66;"></span> IIGs (Licensed Gateways)</div>
            <div class="legend-item"><span class="legend-dot" style="background:#fcc419;"></span> Detected Gateways</div>
            <div class="legend-item"><span class="legend-dot" style="background:#ffa94d;"></span> BD Offshore Peers</div>
            <div class="legend-item"><span class="legend-dot" style="background:#ff6b6b;"></span> Outside BD (International)</div>
          </div>
        </div>

        <!-- IIG list (licensed border gateways) -->
        <div class="sidebar-section-title iig">IIGs (Licensed Gateways)</div>
        <div id="iig-list"></div>

        <!-- Detected Gateways list -->
        <div class="sidebar-section-title detected-iig">Detected Gateways</div>
        <div id="detected-iig-list"></div>

        <!-- BD Offshore Peers list -->
        <div class="sidebar-section-title offshore-peer">BD Offshore Peers</div>
        <div id="offshore-peer-list"></div>

        <!-- Local ISP list -->
        <div class="sidebar-section-title local-isp">Local ISPs</div>
        <div id="local-isp-list"></div>

        <!-- Outside ASN list -->
        <div class="sidebar-section-title outside">Outside BD (International)</div>
        <div id="outside-list"></div>
      </div>
    </aside>

    <!-- Main content -->
    <div id="main">
      <!-- Top bar -->
      <div id="top-bar">
        <div style="font-size:14px; font-weight:600; color: var(--accent);">Bangladesh Internet Path Visualization</div>
      </div>

      <!-- Tab navigation -->
      <nav id="tab-nav">
        <button class="tab-btn active" data-tab="force-graph">Network Graph</button>
        <button class="tab-btn" data-tab="sankey">Traffic Flow</button>
        <button class="tab-btn" data-tab="treemap">Market Share</button>
        <button class="tab-btn" data-tab="chord">Chord Diagram</button>
        <button class="tab-btn" data-tab="hierarchical">Layered View</button>
        <button class="tab-btn" data-tab="table">Data Table</button>
      </nav>

      <!-- Visualization panel -->
      <div id="viz-panel"></div>

      <!-- Footer -->
      <div id="app-footer">
        <span>Data source: <a href="https://stat.ripe.net" target="_blank" rel="noopener">RIPEstat</a> | Local ISP &rarr; Gateway &rarr; International</span>
        <span><a href="#" id="btn-show-intro">About this project</a></span>
      </div>
    </div>
  </div>

  <!-- Shared tooltip -->
  <div class="tooltip" id="tooltip" style="display: none;"></div>

  <!-- Main script -->
  <script type="module" src="assets/js/main.js"></script>
</body>
</html>
